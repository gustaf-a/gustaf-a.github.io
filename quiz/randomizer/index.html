<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Quiz Randomizer</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <style>
        .outreach-advice-tab {
            margin: 20px;
        }

        .card-header {
            font-weight: bold;
            background-color: rgba(125, 125, 125, .2);
        }

        .grey-half-transparent-bg {
            background-color: rgba(125, 125, 125, 1)
        }

        .transparent-background {
            background-color: rgba(250, 250, 250, 0);
        }

        .list-group-item {
            background-color: rgba(250, 250, 250, 0);
            border: 1px solid rgba(125, 125, 125, .2);
        }

        .advice-content-headers {
            margin-bottom: 0;
        }

        hr {
            height: 2px;
            color: rgba(125, 125, 125, 1);
            background-color: rgba(125, 125, 125, 1);
            border: none;
        }


        .selectedChampionClass {
            display: inline;
            color: red;
        }

        .hiddenClass {
            display: none;
        }

        img {
            width: 100%;
        }

        .grey-border {
            border: 10px solid grey;
        }

        .red-border {
            border: 10px dashed red;
        }

        .green-border {
            border: 10px solid green;
        }
    </style>
</head>

<body>
    <div id="menu-big-div">
        <div id="championpicker-bar">
            <ul id="championpicker-list" class="nav nav-tabs">
                <li class="nav-item">
                    <a id="champion-select-0" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-1" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-2" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-3" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-4" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-5" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-6" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-7" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-8" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
                <li class="nav-item">
                    <a id="champion-select-9" onclick="selectChampion(this)" href="#" class="nav-link"></a> </li>
            </ul>
        </div>

        <div id="championToMove" class="justify-content-center row">
            <h1 id="championToMove-text">No champions picked</h1>
        </div>
        <div id="championToMove" class="justify-content-center row">
            <div class="col-lg-4 col-10">
                <img id="championToMove-image" src="" alt="">
            </div>
        </div>
        <br>
        <div class="row justify-content-center" id="allPickedChampions">
            <div id="champion-picked-0" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-1" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-2" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-3" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-4" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-5" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-6" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-7" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-8" class="col-lg-1 col-2 championPicked"></div>
            <div id="champion-picked-9" class="col-lg-1 col-2 championPicked"></div>
        </div>

        <br>
        <div class="row justify-content-center">
            <div class="col-1"></div>
            <div id="control-panel-findNextMove" class="control-panel">
                <button id="button-findNextMove-fast" onclick="findNextToMove(500)" type="button"
                    class="btn-primary btn-sm nextToMoveButton">Next Move Fast</button>
                <button id="button-findNextMove-normal" onclick="findNextToMove(2000)" type="button"
                    class="btn-primary btn-sm nextToMoveButton">Next Move Normal</button>
                <button id="button-findNextMove-slow" onclick="findNextToMove(4000)" type="button"
                    class="btn-primary btn-sm nextToMoveButton">Next Move Slow</button>
                <button id="button-findNextMove-slow" onclick="findNextToMove(8000)" type="button"
                    class="btn-primary btn-sm nextToMoveButton">Next Move Very Slow</button>
            </div>
        </div>
        <br>
        <div class="row justify-content-center">
            <div class="col-1"></div>
            <div class="control-panel">
                <button id="button-control-panel-toggle-menu" onclick="toggleMenu()" type="button"
                    class="btn-primary btn-sm">Toggle Menu</button>
            </div>
        </div>
    </div>

    <script>
        var champions = [
            "Penny the Painless Plant",
            "Archangel Michael - Leader of God's armies",
            "Ganesha",
            "The World Turtle - A’Tuin",
            "An Asian Killer Chicken",
            "An Endless Toilet Roll",
            "POSEIDON - Ruler of the Seas",
            "MOTHER RUSSIA",
            "Harry Fucking Potter",
            "Mickey Mouse & His Evil Laugh"
        ];

        var championsImages = [
            "plantmonster.jpg",
            "archangel.jpg",
            "ganesha.png",
            "turtle.png",
            "chicken.jpg",
            "toilet.jpg",
            "poseidon.jpg",
            "russia.jpg",
            "potter.jpg",
            "mickey.jpg",
        ];

        const championPickedInnerHtml = "<img class=\"img-fluid\" src=\"img/¤¤¤\">";

        var selectedChampions = new Map();

        fillInChampionNames();

        function fillInChampionNames() {
            for (var i = 0; i < champions.length; i++) {
                $("#champion-select-" + i)[0].text = champions[i];
                $("#champion-picked-" + i)[0].innerHTML = championPickedInnerHtml.replace("¤¤¤", championsImages[i]);
            }
        }

        const activeClassActive = 'active';
        const activeClassGrey = 'grey-half-transparent-bg';

        function toggleTabSelected(tab) {
            $(tab).toggleClass(activeClassActive)
            $(tab).toggleClass(activeClassGrey)
        }

        function selectChampion(theItemClicked) {

            if (selectedChampions.has(theItemClicked.text)) {
                selectedChampions.delete(theItemClicked.text);
            } else {
                selectedChampions.set(theItemClicked.text, getChampionIdFromElementId(theItemClicked.id));
            }

            toggleTabSelected(theItemClicked);

            refreshChampionsShowed();
        }

        function getChampionIdFromElementId(idString) {
            return idString.slice(idString.length - 1);
        }

        const selectedChampionClass = "selectedChampionClass";
        const hiddenClass = "hiddenClass";
        const championToMove = "championToMove";

        function refreshChampionsShowed() {
            hideAllPickedChampions();

            for (let [key, value] of selectedChampions) {
                $("#champion-picked-" + value).addClass(selectedChampionClass);
                $("#champion-picked-" + value).removeClass(hiddenClass);
            }
        }

        hideAllPickedChampions();

        function hideAllPickedChampions() {
            for (var i = 0; i < champions.length; i++) {
                $("#champion-picked-" + i)[0].classList.remove(selectedChampionClass);
                $("#champion-picked-" + i)[0].classList.add(hiddenClass);
            }
        }

        function toggleMenu() {
            $("#championpicker-bar").toggleClass(hiddenClass);
        }

        let championToMoveNext;
        let championTextId;
        championTextId = "#" + championToMove + "-text";
        let championImageId;
        championImageId = "#" + championToMove + "-image";

        const animationSpeed = 200; //lower is faster
        const animationDelayNumber = 3;
        let championNumberToAnimateNext;

        function findNextToMove(time) {

            if (selectedChampions.size > 0) {
                enableToMoveButtons(false);
                $(championImageId).attr("src", "img/unknown.png");
                setChampionToMoveBorderStyle("grey-border");
                $(championTextId)[0].innerHTML = "Finding next champion to move";
                let number = Math.floor(Math.random() * selectedChampions.size);
                championToMoveNext = findMapEntryNumber(selectedChampions, number);

                championNumberToAnimateNext = 0;
                for (var i = animationDelayNumber; i < (time / animationSpeed) - 1; i++) {
                    setTimeout(animateChampionToMoveNext, animationSpeed * i);
                }

                setTimeout(updateChampionToMoveText, time);

                enableToMoveButtons(true);
            } else {
                $(championTextId)[0].innerHTML = "Pick champions";
            }
        }

        function setChampionToMoveBorderStyle(newClass) {
            //clear old 
            $(championImageId).removeClass("grey-border");
            $(championImageId).removeClass("red-border");
            $(championImageId).removeClass("green-border");

            //set new
            $(championImageId).addClass(newClass);
        }

        function findMapEntryNumber(map, number) {
            var values = selectedChampions.values();

            for (var i = 0; i < number; i++) {
                values.next().value;
            }
            return values.next().value;
        }

        function enableToMoveButtons(enableButtons) {
            $("nextToMoveButton").prop('disabled', !enableButtons);

            if (enableButtons) {
                $("nextToMoveButton").addClass("btn-primary");
                $("nextToMoveButton").removeClass("btn-secondary");
            } else {
                $("nextToMoveButton").removeClass("btn-primary");
                $("nextToMoveButton").addClass("btn-secondary");
            }
        }

        function animateChampionToMoveNext() {
            setChampionToMoveBorderStyle("red-border");
            setChampionToMoveNext(findMapEntryNumber(selectedChampions, championNumberToAnimateNext));
            setNextAnimateNumber();
        }

        function setNextAnimateNumber() {
            championNumberToAnimateNext++;
            if (championNumberToAnimateNext >= selectedChampions.size) {
                championNumberToAnimateNext = 0;
            }
        }

        function updateChampionToMoveText() {
            setChampionToMoveNext(championToMoveNext);
            setChampionToMoveBorderStyle("green-border");
        }

        function setChampionToMoveNext(championNumber) {
            $(championTextId)[0].innerHTML = champions[championNumber];
            $(championImageId).attr("src", "img/" + championsImages[championNumber]);
        }

    </script>
</body>

</html>